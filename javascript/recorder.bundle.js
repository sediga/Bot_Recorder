(()=>{function R(t){let a={};for(let r of t.attributes)r.name&&r.value&&(a[r.name]=r.value);return a}function st(t){if(!t||!t.textContent)return"";let a=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null),r=[];for(;a.nextNode();){let s=a.currentNode.textContent.trim().replace(/\s+/g," ");s&&s.length<100&&r.push(s)}return r.length===0?"":r.sort((s,p)=>s.length-p.length)[0].replace(/["']/g,"")}function at(t){let a=t.tagName.toLowerCase(),r=t.getAttribute("role")||"",l=Array.from(t.classList).join(" ").toLowerCase();return["a","button"].includes(a)||["button","link"].includes(r)||t.hasAttribute("onclick")||t.hasAttribute("tabindex")||/cursor-pointer|clickable|btn|card|link|action|nav/i.test(l)}function lt(t){let a=["BODY","HTML","MAIN"],r=[/^min-h-screen$/,/^bg-/,/^text-/];return!t||a.includes(t.tagName)?!0:Array.from(t.classList).some(s=>r.some(p=>p.test(s)))}function ct(t){for(;t&&t!==document.body&&!at(t)&&!lt(t);)t=t.parentElement;return t}function dt(t){if(!t||t.length<6)return!1;if(t.length>16)return!0;if(/^[A-Za-z0-9_-]{10,}$/.test(t)){let a=/[a-z]/.test(t)&&/[A-Z]/.test(t),r=/\d/.test(t);return a&&r}return!1}function z(t){if(!t||t===document||t.nodeType!==1)return"";if(t.tagName==="SPAN"&&t.textContent.trim()==="*"){let c=t.closest("label");if(c?.htmlFor)return`#${CSS.escape(c.htmlFor)}`;let g=t.closest("div")?.querySelector("input, textarea, select");if(g)return z(g)}if(t.tagName==="LABEL"&&t.htmlFor)return`#${CSS.escape(t.htmlFor)}`;if(["DIV","SPAN"].includes(t.tagName)){let c=t.querySelector("label[for]");if(c){let _=document.getElementById(c.htmlFor);if(_)return z(_)}let g=t.querySelector("input, textarea, select");if(g)return z(g)}let r=t.matches("input, textarea, select")?t:ct(t)||t,l=r.tagName.toLowerCase(),s=st(r);if(r.getAttribute("data-testid"))return`[data-testid="${CSS.escape(r.getAttribute("data-testid"))}"]`;let p=r.getAttribute("aria-label");if(p){let c=r.closest('div[role="columnheader"][data-field]');if(c){let g=c.getAttribute("data-field");return`div[role="columnheader"][data-field="${CSS.escape(g)}"] [aria-label="${CSS.escape(p)}"]`}return`[aria-label="${CSS.escape(p)}"]`}if(r.id&&!dt(r.id))return`#${CSS.escape(r.id)}`;if(r.name)return`[name="${CSS.escape(r.name)}"]`;if(r.placeholder)return`[placeholder="${CSS.escape(r.placeholder)}"]`;if(r.getAttribute("role")==="columnheader"&&r.hasAttribute("data-field"))return`div[role="columnheader"][data-field="${CSS.escape(r.getAttribute("data-field"))}"]`;if(l==="button"&&s)return`button:has-text("${s}")`;if(l==="a"&&s)return`a:has-text("${s}")`;let N=r.getAttribute("type"),$=r.getAttribute("role");if(l==="input"&&N==="button"&&r.value)return`input[type="button"][value="${CSS.escape(r.value)}"]`;if(($==="button"||$==="link")&&s)return`[role="${CSS.escape($)}"]:has-text("${s}")`;let F=Array.from(r.classList).filter(c=>/^[a-zA-Z0-9_-]+$/.test(c)),S="";F.length&&(S="."+F.slice(0,3).map(CSS.escape).join("."));let A=`${l}${S}`;s&&(A+=`:has-text("${s}")`);let V=Array.from(document.querySelectorAll(l)).filter(c=>c.textContent?.includes(s));if(V.length>1){let c=V.indexOf(r);c>=0&&(A+=`:nth-of-type(${c+1})`)}return A.startsWith('body:has-text("*")')?"":A}function ut(t){if(!(t instanceof Element))return"";let a=[];for(;t&&t.nodeType===Node.ELEMENT_NODE;){let r=t.nodeName.toLowerCase();if(t.id){r=`#${CSS.escape(t.id)}`,a.unshift(r);break}else{let s=(t.className||"").toString().trim().replace(/\s+/g,".");s&&(r+="."+s.replace(/^\.+/,""))}let l=t.parentNode;if(l){let s=Array.from(l.children).filter(p=>p.tagName===t.tagName);if(s.length>1){let p=s.indexOf(t)+1;r+=`:nth-child(${p})`}}a.unshift(r),t=t.parentNode}return a.join(" > ")}function G(t){if(!t)return null;let a=[],r=R(t),l=t.tagName.toLowerCase();if(t.id&&a.push({selector:`#${CSS.escape(t.id)}`,source:"id",score:100}),t.getAttribute("data-testid")&&a.push({selector:`[data-testid="${t.getAttribute("data-testid")}"]`,source:"data-testid",score:90}),t.getAttribute("aria-label")&&a.push({selector:`[aria-label="${t.getAttribute("aria-label")}"]`,source:"aria-label",score:85}),t.getAttribute("name")&&a.push({selector:`[name="${t.getAttribute("name")}"]`,source:"name",score:80}),t.classList.length){let p=`${l}.${[...t.classList].map(N=>CSS.escape(N)).join(".")}`;a.push({selector:p,source:"class",score:70})}let s=t.innerText?.trim();return s&&a.push({selector:`${l}:has-text("${s.slice(0,50)}")`,source:"has-text",score:40}),a.push({selector:X(t),source:"dom-path",score:30}),a.push({selector:Y(t),source:"xpath",score:20}),{text:s,selectors:a,attributes:r,boundingBox:t.getBoundingClientRect?.()||null}}window.captureSelectors=G;function X(t){let a=[];for(;t&&t.nodeType===Node.ELEMENT_NODE;){let r=t.nodeName.toLowerCase();if(t.id)r+=`#${CSS.escape(t.id)}`;else{let l=Array.from(t.parentNode?.children||[]).filter(s=>s.nodeName===t.nodeName);if(l.length>1){let s=l.indexOf(t);r+=`:nth-of-type(${s+1})`}}a.unshift(r),t=t.parentElement}return a.join(" > ")}function Y(t){if(t.id)return`//*[@id="${t.id}"]`;let a=[];for(;t&&t.nodeType===1;){let r=1,l=t.previousSibling;for(;l;)l.nodeType===1&&l.tagName===t.tagName&&r++,l=l.previousSibling;let s=t.tagName.toLowerCase(),p=r>1?`${s}[${r}]`:s;a.unshift(p),t=t.parentNode}return"/"+a.join("/")}window.getSmartSelectorLib={getSmartSelector:z,getDevtoolsLikeSelector:ut};(function(){if(console.debug("[Botflows] Recorder script starting execution..."),window.__recorderInjected){console.debug(`[Botflows] Recorder already injected at ${window.__recorderInjectedTime}, skipping.`);return}window.__recorderInjected=!0,window.__recorderInjectedTime=new Date().toISOString(),console.debug("[Botflows] Recorder script injected successfully");let t={selector:null,timestamp:0},a={selector:null,timestamp:0},r=()=>window.__pickModeActive===!0;function l(n){if(!n||typeof n.getBoundingClientRect!="function")return!0;let o=n.getBoundingClientRect();if(o.width<2||o.height<2||!n.offsetParent)return!0;let i=window.getComputedStyle(n);if(i.pointerEvents==="none"||i.visibility!=="visible"||i.display==="none")return!0;let e=["HTML","BODY","DIV","SPAN","P"],d=n.tagName,u=(n.innerText||"").trim(),b=n.closest("a, button, input, select, textarea, [role='button'], [onclick], [tabindex]");return!!(e.includes(d)&&!b&&u==="")}function s(){if(document.getElementById("__botflows_validation_overlay"))return;let n=document.createElement("div");n.id="__botflows_validation_overlay",Object.assign(n.style,{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"rgba(255, 255, 255, 0.6)",zIndex:999999,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"22px",fontFamily:"sans-serif",fontWeight:"bold",color:"#333"}),n.innerText="Validating action\u2026 Please wait",document.body.appendChild(n)}function p(n){if(document.getElementById("botflows-prompt"))return;window.__pendingValidation=!0;let o=document.createElement("div");o.id="botflows-prompt",o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100vw",o.style.height="100vh",o.style.backgroundColor="rgba(0,0,0,0.5)",o.style.zIndex=9999,o.style.display="flex",o.style.alignItems="center",o.style.justifyContent="center",o.style.fontFamily="Arial, sans-serif",o.setAttribute("data-botflows-ui","true");let i=document.createElement("div");i.style.background="white",i.style.padding="20px",i.style.borderRadius="12px",i.style.width="460px",i.style.boxShadow="0 5px 15px rgba(0,0,0,0.3)",i.setAttribute("data-botflows-ui","true"),i.innerHTML=`
      <h2 style="margin-top:0; font-size:20px; color:#333;">\u{1F501} Botflows \u2013 Row Action Condition</h2>
      <p style="margin: 10px 0;">Only click this element if a column in the current row matches:</p>
      
      <label for="grid-column">Column Name:</label>
      <input id="grid-column" placeholder="e.g. Status" style="width:100%; padding:8px; font-size:14px; margin-bottom:10px;" />

      <label for="grid-value">Equals Value:</label>
      <input id="grid-value" placeholder="e.g. Pending" style="width:100%; padding:8px; font-size:14px;" />

      <div style="margin-top:20px; display: flex; justify-content: flex-end; gap: 10px;">
        <button id="cancel-btn" style="padding: 6px 12px; background: #eee; border: 1px solid #ccc;">Cancel</button>
        <button id="submit-btn" style="padding: 6px 12px; background: #2563eb; color: white; border: none;">Submit</button>
      </div>
    `,o.appendChild(i),document.body.appendChild(o);let e=i.querySelector("#grid-column"),d=i.querySelector("#grid-value");e.focus(),i.querySelector("#cancel-btn").onclick=()=>{document.body.removeChild(o),window.__pendingValidation=!1,n(null,null)},i.querySelector("#submit-btn").onclick=()=>{let u=e.value.trim(),b=d.value.trim();document.body.removeChild(o),window.__pendingValidation=!1,n(u||null,b||null)}}function N(n){if(document.getElementById("botflows-prompt"))return;window.__pendingValidation=!0;let o=document.createElement("div");o.id="botflows-prompt",o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100vw",o.style.height="100vh",o.style.backgroundColor="rgba(0,0,0,0.5)",o.style.zIndex=9999,o.style.display="flex",o.style.alignItems="center",o.style.justifyContent="center",o.style.fontFamily="Arial, sans-serif",o.setAttribute("data-botflows-ui","true");let i=document.createElement("div");i.style.background="white",i.style.padding="20px",i.style.borderRadius="12px",i.style.width="460px",i.style.boxShadow="0 5px 15px rgba(0,0,0,0.3)",i.setAttribute("data-botflows-ui","true");let e=[{value:"firstActiveDate",label:"First Active Date"},{value:"today",label:"Today"},{value:"nextWeekday",label:"Next Weekday"},{value:"specificDate",label:"Specific Date (Coming Soon)"}];i.innerHTML=`
      <h2 style="margin-top:0; font-size:20px; color:#333;">\u{1F4C5} Botflows \u2013 Date Picker Criteria</h2>
      <p style="margin: 10px 0;">Choose how this date should be selected during automation:</p>

      <label for="botflows-date-criteria">Date Selection:</label>
      <select id="botflows-date-criteria" style="width:100%; padding:8px; font-size:14px;">
        ${e.map(u=>`<option value="${u.value}">${u.label}</option>`).join("")}
      </select>

      <div style="margin-top:20px; display: flex; justify-content: flex-end; gap: 10px;">
        <button id="cancel-btn" style="padding: 6px 12px; background: #eee; border: 1px solid #ccc;">Cancel</button>
        <button id="submit-btn" style="padding: 6px 12px; background: #2563eb; color: white; border: none;">Submit</button>
      </div>
    `,o.appendChild(i),document.body.appendChild(o);let d=i.querySelector("#botflows-date-criteria");i.querySelector("#cancel-btn").onclick=()=>{document.body.removeChild(o),window.__pendingValidation=!1,n(null)},i.querySelector("#submit-btn").onclick=()=>{let u=d.value;document.body.removeChild(o),window.__pendingValidation=!1,n(u)}}function $(n,o){if(document.getElementById("botflows-prompt"))return;let i=document.createElement("div");i.id="botflows-prompt",i.style.position="fixed",i.style.top="0",i.style.left="0",i.style.width="100vw",i.style.height="100vh",i.style.backgroundColor="rgba(0,0,0,0.5)",i.style.zIndex=9999,i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="center",i.style.fontFamily="Arial, sans-serif",i.setAttribute("data-botflows-ui","true");let e=document.createElement("div");e.style.background="white",e.style.padding="20px",e.style.borderRadius="12px",e.style.width="460px",e.style.boxShadow="0 5px 15px rgba(0,0,0,0.3)",e.setAttribute("data-botflows-ui","true");let d=null,u="",b="regex";function D(){return d==null?"":n[d]?.preview||""}function w(f){if(!f)return"";try{if(b==="regex"){let E=new RegExp(u),I=f.match(E);return I?.[1]||I?.[0]||"(no match)"}else if(b==="js")return new Function("value",`return value${u}`)(f)}catch{return"(error)"}return f}window.getTransformedPreview=w;function y(){e.querySelector("#botflows-raw-value").textContent=D(),e.querySelector("#botflows-transformed-value").textContent=w(D())}e.innerHTML=`
      <h2 style="margin-top:0; font-size:20px; color:#333;">\u{1F501} Botflows \u2013 Map Field to Column</h2>
      <p style="margin: 10px 0;">Select a column to map this input to:</p>
      <select id="column-select" style="width:100%; padding:8px; font-size:14px;">
        <option value="">-- Skip Mapping --</option>
        ${n.map((f,E)=>`<option value="${E}">${f.label}</option>`).join("")}
      </select>
      <p style="margin: 10px 0 5px;">Transform type:</p>
      <select id="transform-type" style="width:100%; padding:8px; font-size:14px;">
        <option value="regex">Regex</option>
        <option value="js">JS Expression (e.g. .trim(), .slice(0,3))</option>
      </select>
      <p style="margin: 10px 0 5px;">Transformation rule:</p>
      <input id="transform-input" type="text" placeholder="e.g., (.+?)\\s or .trim()" style="width:100%; padding:8px; font-size:14px;" />
      <div style="margin-top:16px; font-style:italic;">
        <div>Raw: <span id="botflows-raw-value" style="font-weight:bold;"></span></div>
        <div>Result: <span id="botflows-transformed-value" style="font-weight:bold;"></span></div>
      </div>
      <div style="margin-top:20px; display: flex; justify-content: flex-end; gap: 10px;">
        <button id="cancel-btn" style="padding: 6px 12px; background: #eee; border: 1px solid #ccc;">Cancel</button>
        <button id="submit-btn" style="padding: 6px 12px; background: #2563eb; color: white; border: none;">Submit</button>
      </div>
    `,i.appendChild(e),document.body.appendChild(i),e.querySelector("#column-select").onchange=f=>{d=parseInt(f.target.value),y()},e.querySelector("#transform-input").oninput=f=>{u=f.target.value,y()},e.querySelector("#transform-type").onchange=f=>{b=f.target.value,y()},e.querySelector("#cancel-btn").onclick=()=>{document.body.removeChild(i),o(null)},e.querySelector("#submit-btn").onclick=()=>{document.body.removeChild(i),o(d!=null?{index:d,transform:u,transformType:b}:null)}}function F(n){if(!n)return[];if(n.type==="gridExtract"){debugger;return(n.columnMappings||[]).map((o,i)=>({label:`${i+1}. ${o.header?.header||"Unnamed"}`,value:o.header?.header||"",preview:o.preview||"sample"}))}return n.type==="apiExtract"?(n.fields||[]).map(o=>({label:o.path,value:o.path,preview:o.preview||"sample"})):[]}function S(){let n=document.getElementById("__botflows_validation_overlay");n&&n.remove()}window.hideValidationOverlay=S,window.showValidationOverlay=s;function A(n){return n.closest("[data-botflows-ui]")}let O=(n,o={})=>{if(window.__botflows_replaying__){console.debug("[Botflows] In replay mode \u2014 event suppressed:",n.type);return}if(r()){console.debug("[Botflows] In pick mode \u2014 event suppressed:",n.type);return}if(window.__pendingValidation){console.debug("[Botflows] Skipping event while previous validation is pending");return}let i=n.target,e=i.closest('a, button, input[type="button"], [role="button"]')||i,d=n.type;if(A(e)){console.debug("[Botflows] Skipping event from Botflows UI:",e);return}if(!e||e===document||e===document.body||!document.contains(e)||typeof window.sendEventToPython!="function"||d==="click"&&l(e)){console.debug("[Botflows] Ignoring untrackable target:",e);return}let u=Date.now(),b=G(e);function D(x){return!x||!x.selectors||x.selectors.length===0?null:x.selectors.reduce((k,v)=>k.score>v.score?k:v).selector}let w=D(b),y=window.getComputedStyle(e),f=!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&y.visibility!=="hidden"&&y.display!=="none",I=window.self!==window.top?window.frameElement?.getAttribute("name")||window.frameElement?.getAttribute("id")||window.frameElement?.getAttribute("data-botflows-frame")||"__unnamed_frame__":null,H={tagName:e.tagName.toLowerCase(),id:e.id||null,name:e.getAttribute("name")||null,classList:Array.from(e.classList||[]),attributes:R(e),text:e.innerText?.trim()||"",elementText:e.textContent?.trim()||"",boundingBox:e.getBoundingClientRect?.(),outerHTML:e.outerHTML||"",selector:w||"",domPath:X(e),xpath:Y(e),frameContext:I,frameUrl:window.location.href,isVisible:f,computedStyles:{display:y.display,visibility:y.visibility,pointerEvents:y.pointerEvents}};if(H.frameContext=I,H.frameUrl=window.location.href,d==="click"&&w===t.selector&&u-t.timestamp<80){console.debug("[Botflows] Suppressed duplicate click:",w);return}if(d==="focus"){let x=e.tagName.toLowerCase();if(!["input","textarea","select"].includes(x)){console.debug("[Botflows] Ignored focus event on non-input element:",x);return}}d==="click"&&(t={selector:w,timestamp:u}),d==="focus"&&(a={selector:w,timestamp:u});let U={action:d==="input"?"type":d,url:window.location.href,value:e.value||null,timestamp:u,...H},ot=window.loopContext?.sourceStep,M=F(ot);if(window.loopContext?.active&&M.length&&["input","select","textarea","a","button"].includes(e.tagName.toLowerCase())&&e.getAttribute("data-botflows-mapped")!==window.loopContext?.loopName){if(typeof e.value=="string"&&/\{\{.*\}\}/.test(e.value)){let k=e.value.match(/\{\{(.*?)\}\}/)?.[1]?.trim(),v=M.find(tt=>tt.value===k);if(v){e.setAttribute("data-botflows-mapped",window.loopContext?.loopName||"global"),e.setAttribute("data-dynamic-value",`{{${v.value}}}`),e.dispatchEvent(new Event("change",{bubbles:!0})),console.debug(`[Botflows] Auto-mapped input to: {{${v.value}}}`),h();return}}let x=["select","a","button","div"].includes(e.tagName.toLowerCase())||["combobox","link","option"].includes(e.getAttribute("role"));debugger;if(x||e.tagName.toLowerCase()==="input"){debugger;let W=(e.getAttribute("type")||"").toLowerCase(),k=(e.getAttribute("name")||"").toLowerCase(),v=(e.className||"").toLowerCase();if(d==="click"&&window.loopContext?.active){let rt=function(q){return q.tagName.toLowerCase()==="input"&&["text","search"].includes(it)?"type":q.tagName.toLowerCase()==="select"?"select":(["button","a","div"].includes(P)||["button","link"].includes(nt),"click")},m=e.closest("[role='row'], tr, .MuiDataGrid-row, .sticky-row, [data-row], [data-rowindex]");if(!m){console.warn("[Botflows] No row found"),h();return}let Z=m.closest("[role='grid'], table, .MuiDataGrid-root, .patient-list-grid, [data-grid]"),T=Array.from(m.querySelectorAll("[role='gridcell'], [role='cell']"));T.length===0&&(T=Array.from(m.children||[]));let C=T.findIndex(q=>q.contains(e)),L=window.loopContext?.sourceStep?.columnMappings||[];if(C<0||C>=L.length){console.warn("[Botflows] Couldn't resolve clicked column index"),h();return}let B=L[C]?.header||`Column ${C+1}`,P=e.tagName.toLowerCase(),nt=e.getAttribute("role")?.toLowerCase()||"",it=e.getAttribute("type")?.toLowerCase()||"",et=rt(e);window.__botflowsTempStepExtras__={type:"clickInColumn",columnIndex:C,columnHeader:B,actionType:et,targetTag:P,selector:w},console.debug(`[Botflows] Auto-captured smart column action \u2192 column ${C} (${B}), action: ${et}, tag: ${P}`),h();return}if(W==="date"||k.includes("date")||v.includes("date")||v.includes("calendar")){debugger;N(m=>{if(!m){e.setAttribute("data-botflows-mapped",window.loopContext?.loopName||"global"),h();return}e.setAttribute("data-botflows-date-criteria",m),e.setAttribute("data-botflows-mapped",window.loopContext?.loopName||"global"),window.__botflowsTempStepExtras__={dateCriteria:m},h()});return}$(M,m=>{if(!m){e.setAttribute("data-botflows-mapped",window.loopContext?.loopName||"global"),h();return}let Z=M[m.index],T=`{{${Z.value}}}`,C=Z.preview||"sample",L=m.transformType||null,B=m.transform||"",P=window.getTransformedPreview(C)||C;e.value=P,e.setAttribute("data-botflows-mapped",window.loopContext?.loopName||"global"),e.setAttribute("data-dynamic-value",T),L&&(e.setAttribute("data-transform-type",L),e.setAttribute("data-transform",B)),e.dispatchEvent(new Event("input",{bubbles:!0})),e.dispatchEvent(new Event("change",{bubbles:!0})),console.debug(`[Botflows] Mapped input to: ${T} (with ${L||"no"} transform: ${B})`),h()});return}}h();function h(){window.__botflowsTempStepExtras__&&(Object.assign(U,window.__botflowsTempStepExtras__),window.__botflowsTempStepExtras__=null),console.debug("[Botflows] Sending event to Python:",U),window.__pendingValidation=!0,s(),window.sendEventToPython(U),V()}};window.__recorderListenersAttached||(window.__recorderListenersAttached=!0,["click","focus","change","dblclick"].forEach(n=>{document.addEventListener(n,O,!0),console.debug(`[Botflows] Event listener attached for ${n}`)}));function V(n=5e3){return new Promise(o=>{let i=e=>{e.data?.type==="validationComplete"&&(window.removeEventListener("message",i),window.__pendingValidation=!1,S(),o())};window.addEventListener("message",i),setTimeout(()=>{window.removeEventListener("message",i),console.warn("[Botflows] Validation timeout"),window.__pendingValidation=!1,S(),o()},n)})}let c=null,g="";function _(n){let o=n.value||"";if(o!==g){g=o;let i=new Event("input");i.target=n,O(i)}}document.addEventListener("input",n=>{if(r())return;let o=n.target;o.matches("input, textarea")&&(clearTimeout(c),c=setTimeout(()=>_(o),300))},!0),document.addEventListener("keydown",n=>{if(r())return;let o=n.target;o.matches("input, textarea")&&n.key==="Enter"&&(clearTimeout(c),_(o))},!0),document.addEventListener("blur",n=>{if(r())return;let o=n.target;o.matches("input, textarea, select")&&(clearTimeout(c),_(o))},!0);let J=window.location.href,j=()=>{let n=window.location.href;n!==J&&typeof window.sendUrlChangeToPython=="function"&&(J=n,console.debug("[Botflows] Detected SPA URL change:",n),window.sendUrlChangeToPython(n))},K=()=>{document.body?(console.debug("[Botflows] Setting up mutation observer for body"),new MutationObserver(j).observe(document.body,{childList:!0,subtree:!0})):setTimeout(K,100)};K();let Q=n=>{let o=history[n];history[n]=function(...i){o.apply(this,i),console.debug(`[Botflows] Intercepted history.${n}`),j()}};window.addEventListener("popstate",j),j(),Q("pushState"),Q("replaceState")})();})();
